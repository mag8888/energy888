# Energy of Money - Rooms Module

–ú–æ–¥—É–ª—å —Å–∏—Å—Ç–µ–º—ã –∫–æ–º–Ω–∞—Ç –¥–ª—è –∏–≥—Ä—ã "Energy of Money" —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π MongoDB, Socket.IO –∏ –≤—ã–±–æ—Ä–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–π.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–≤—ã–º–∏ –∫–æ–º–Ω–∞—Ç–∞–º–∏ (2-10 –∏–≥—Ä–æ–∫–æ–≤)
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –≤—ã–±–æ—Ä–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–π (3 —Ä–µ–∂–∏–º–∞: random, choice, assigned)
- ‚úÖ –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ MongoDB
- ‚úÖ Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Socket.IO
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- ‚úÖ –ó–∞–ª —Å–ª–∞–≤—ã –∏–≥—Ä–æ–∫–æ–≤

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è

```
modules/rooms/
‚îú‚îÄ‚îÄ controllers/          # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ RoomController.ts
‚îú‚îÄ‚îÄ models/              # –ú–æ–¥–µ–ª–∏ MongoDB
‚îÇ   ‚îú‚îÄ‚îÄ RoomModel.ts
‚îÇ   ‚îî‚îÄ‚îÄ HallOfFameModel.ts
‚îú‚îÄ‚îÄ services/            # –°–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îî‚îÄ‚îÄ DatabaseService.ts
‚îú‚îÄ‚îÄ types/               # TypeScript —Ç–∏–ø—ã
‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îú‚îÄ‚îÄ utils/               # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ roomUtils.ts
‚îÇ   ‚îî‚îÄ‚îÄ professions.ts
‚îú‚îÄ‚îÄ index.ts             # –ì–ª–∞–≤–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç
‚îú‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ tsconfig.json
```

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
cd modules/rooms
npm install
```

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ò–º–ø–æ—Ä—Ç –º–æ–¥—É–ª—è

```typescript
import { 
  RoomController, 
  DatabaseService, 
  PROFESSIONS, 
  ROOM_CONFIGS 
} from './modules/rooms/index.js';
```

### –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞

```typescript
const roomController = new RoomController();
```

### –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã

```typescript
const roomData = {
  name: '–ú–æ—è –∫–æ–º–Ω–∞—Ç–∞',
  maxPlayers: 6,
  timing: 120,
  playerName: '–ò–≥—Ä–æ–∫',
  playerEmail: 'player@example.com',
  professionSelectionMode: 'choice',
  availableProfessions: ['entrepreneur', 'doctor', 'teacher'],
  assignProfessionToAll: false
};

const result = await roomController.createRoom(roomData);
if (result.success) {
  console.log('–ö–æ–º–Ω–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞:', result.room.id);
}
```

### –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –∫–æ–º–Ω–∞—Ç–µ

```typescript
const joinData = {
  roomId: 'room_123',
  playerName: '–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫',
  playerEmail: 'newplayer@example.com'
};

const result = await roomController.joinRoom(joinData, socketId);
if (result.success) {
  console.log('–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å –∫ –∫–æ–º–Ω–∞—Ç–µ');
}
```

## üé≠ –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–π

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏

- **–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å** - —Å–æ–∑–¥–∞–µ—Ç –±–∏–∑–Ω–µ—Å, –≤—ã—Å–æ–∫–∏–π –¥–æ—Ö–æ–¥
- **–í—Ä–∞—á** - —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥, –ª–µ—á–∏—Ç –ª—é–¥–µ–π
- **–£—á–∏—Ç–µ–ª—å** - —Å–∫—Ä–æ–º–Ω—ã–π –Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥
- **–ò–Ω–∂–µ–Ω–µ—Ä** - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ—Ö–æ–¥, —Å–æ–∑–¥–∞–µ—Ç —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **–•—É–¥–æ–∂–Ω–∏–∫** - —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π –¥–æ—Ö–æ–¥, –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–π
- **–Æ—Ä–∏—Å—Ç** - –≤—ã—Å–æ–∫–∏–π –¥–æ—Ö–æ–¥ –æ—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π
- **–£—á–µ–Ω—ã–π** - –¥–æ—Ö–æ–¥ –æ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –∏ –≥—Ä–∞–Ω—Ç–æ–≤
- **–ü–æ–≤–∞—Ä** - –¥–æ—Ö–æ–¥ –æ—Ç —Ä–µ—Å—Ç–æ—Ä–∞–Ω–Ω–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞
- **–ú—É–∑—ã–∫–∞–Ω—Ç** - –¥–æ—Ö–æ–¥ –æ—Ç –∫–æ–Ω—Ü–µ—Ä—Ç–æ–≤ –∏ –∑–∞–ø–∏—Å–µ–π
- **–°–ø–æ—Ä—Ç—Å–º–µ–Ω** - –¥–æ—Ö–æ–¥ –æ—Ç —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π

### –†–µ–∂–∏–º—ã –≤—ã–±–æ—Ä–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–π

1. **Random** - —Å–ª—É—á–∞–π–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏
2. **Choice** - –∏–≥—Ä–æ–∫–∏ –≤—ã–±–∏—Ä–∞—é—Ç –∏–∑ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
3. **Assigned** - –≤—Å–µ –ø–æ–ª—É—á–∞—é—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏—é —Å–æ–∑–¥–∞—Ç–µ–ª—è

## üîå Socket.IO Events

### –ö–ª–∏–µ–Ω—Ç ‚Üí –°–µ—Ä–≤–µ—Ä

- `get-rooms` - –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç
- `create-room` - —Å–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É
- `join-room` - –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∫–æ–º–Ω–∞—Ç–µ
- `select-profession` - –≤—ã–±—Ä–∞—Ç—å –ø—Ä–æ—Ñ–µ—Å—Å–∏—é
- `confirm-profession` - –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤—ã–±–æ—Ä
- `get-available-professions` - –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏

### –°–µ—Ä–≤–µ—Ä ‚Üí –ö–ª–∏–µ–Ω—Ç

- `rooms-list` - —Å–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç
- `room-created` - –∫–æ–º–Ω–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞
- `room-joined` - –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å –∫ –∫–æ–º–Ω–∞—Ç–µ
- `room-updated` - –∫–æ–º–Ω–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- `profession-selected` - –ø—Ä–æ—Ñ–µ—Å—Å–∏—è –≤—ã–±—Ä–∞–Ω–∞
- `profession-confirmed` - –ø—Ä–æ—Ñ–µ—Å—Å–∏—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
- `available-professions` - –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –ú–æ–¥–µ–ª—å Room

```typescript
interface Room {
  id: string;
  name: string;
  maxPlayers: number;
  players: Map<string, Player>;
  professionSelectionMode: 'random' | 'choice' | 'assigned';
  availableProfessions: string[];
  // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
}
```

### –ú–æ–¥–µ–ª—å Player

```typescript
interface Player {
  id: string;
  name: string;
  profession: string | null;
  selectedProfession: string | null;
  professionConfirmed: boolean;
  // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
}
```

## üìä API Endpoints

- `GET /` - —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞
- `GET /health` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
- `GET /stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
- `GET /professions` - —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—Ñ–µ—Å—Å–∏–π
- `GET /rooms` - —Å–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
MONGODB_URI=mongodb://localhost:27017/energy888
PORT=4000
NODE_ENV=development
FRONT_ORIGIN=*
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–Ω–∞—Ç

```typescript
const ROOM_CONFIGS = {
  QUICK_GAME: {
    maxPlayers: 4,
    timing: 60,
    professionSelectionMode: 'random'
  },
  STRATEGIC_GAME: {
    maxPlayers: 6,
    timing: 180,
    professionSelectionMode: 'choice'
  }
};
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
npm test
```

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ú–æ–¥—É–ª—å –≤—ã–≤–æ–¥–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏:
- `‚úÖ` - —É—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- `‚ùå` - –æ—à–∏–±–∫–∏
- `üîÑ` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- `üè†` - –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫–æ–º–Ω–∞—Ç–∞–º–∏
- `üé≠` - –≤—ã–±–æ—Ä –ø—Ä–æ—Ñ–µ—Å—Å–∏–π

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ MongoDB
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:

```bash
node rooms-server.js
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á–µ—Ä–µ–∑ `/stats` endpoint
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## ü§ù –í–∫–ª–∞–¥ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É

1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏
3. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. –°–æ–∑–¥–∞–π—Ç–µ Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License
