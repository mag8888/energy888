<!DOCTYPE html>
<html>
<head>
    <title>–¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç</title>
    <script src="https://cdn.socket.io/4.8.1/socket.io.min.js"></script>
</head>
<body>
    <h1>–¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç</h1>
    <div id="status">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</div>
    <button onclick="testCreateRoom()">–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –∫–æ–º–Ω–∞—Ç—É</button>
    <button onclick="getRooms()">–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç</button>
    <div id="logs"></div>

    <script>
        const socket = io('https://botenergy-7to1-production.up.railway.app', {
            transports: ['websocket', 'polling'],
            timeout: 10000
        });
        
        function log(message) {
            console.log(message);
            document.getElementById('logs').innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
        }
        
        socket.on('connect', () => {
            log('‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω –∫ —Å–µ—Ä–≤–µ—Ä—É: ' + socket.id);
            document.getElementById('status').textContent = '–ü–æ–¥–∫–ª—é—á–µ–Ω: ' + socket.id;
        });
        
        socket.on('disconnect', () => {
            log('‚ùå –û—Ç–∫–ª—é—á–µ–Ω –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞');
            document.getElementById('status').textContent = '–û—Ç–∫–ª—é—á–µ–Ω';
        });
        
        socket.on('connect_error', (error) => {
            log('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ' + error.message);
            document.getElementById('status').textContent = '–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è';
        });
        
        socket.on('room-created', (room) => {
            log('‚úÖ –ö–æ–º–Ω–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞: ' + JSON.stringify(room));
        });
        
        socket.on('rooms-list', (rooms) => {
            log('üìã –°–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç: ' + JSON.stringify(rooms));
        });
        
        socket.on('error', (error) => {
            log('‚ùå –û—à–∏–±–∫–∞: ' + JSON.stringify(error));
        });
        
        function testCreateRoom() {
            log('üè† –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—É—é –∫–æ–º–Ω–∞—Ç—É...');
            socket.emit('create-room', {
                name: '–¢–µ—Å—Ç–æ–≤–∞—è –∫–æ–º–Ω–∞—Ç–∞',
                maxPlayers: 4,
                creatorUsername: '–¢–µ—Å—Ç–µ—Ä',
                professionSelectionMode: 'assigned',
                timing: 120
            });
        }
        
        function getRooms() {
            log('üìã –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç...');
            socket.emit('get-rooms');
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
        socket.on('connect', () => {
            setTimeout(() => {
                getRooms();
            }, 1000);
        });
    </script>
</body>
</html>
