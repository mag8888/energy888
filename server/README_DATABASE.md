# Energy of Money - Server with Database

## –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### ‚úÖ –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∫–æ–º–Ω–∞—Ç
- –ö–æ–º–Ω–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ MongoDB
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–º–Ω–∞—Ç –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç

### ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- –≠–Ω–¥–ø–æ–∏–Ω—Ç `/stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
- –≠–Ω–¥–ø–æ–∏–Ω—Ç `/hall-of-fame` - —Ç–æ–ø –∏–≥—Ä–æ–∫–æ–≤
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–æ–º–Ω–∞—Ç

### ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ—á–∏—Å—Ç–∫–∏
- –ö–æ–º–Ω–∞—Ç—ã —É–¥–∞–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ (–≤–º–µ—Å—Ç–æ 5)
- –£–¥–∞–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—É—Å—Ç—ã–µ –∫–æ–º–Ω–∞—Ç—ã
- –ó–∞–¥–µ—Ä–∂–∫–∞ –≤ 1 —á–∞—Å –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º –ø—É—Å—Ç—ã—Ö –∫–æ–º–Ω–∞—Ç

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ MongoDB

#### –õ–æ–∫–∞–ª—å–Ω–æ (macOS):
```bash
brew install mongodb-community
brew services start mongodb-community
```

#### –õ–æ–∫–∞–ª—å–Ω–æ (Ubuntu/Debian):
```bash
sudo apt-get install mongodb
sudo systemctl start mongodb
```

#### Docker:
```bash
docker run -d -p 27017:27017 --name mongodb mongo:latest
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
cd server
npm install
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:
```env
MONGODB_URI=mongodb://localhost:27017/energy888
PORT=4000
NODE_ENV=development
FRONT_ORIGIN=*
```

### 4. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
npm start
```

## API Endpoints

### –û—Å–Ω–æ–≤–Ω—ã–µ
- `GET /` - —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞
- `GET /stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
- `GET /hall-of-fame?limit=10&sortBy=points` - —Ç–æ–ø –∏–≥—Ä–æ–∫–æ–≤

### Telegram Bot
- `GET /tg/new-token` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
- `POST /tg/bot-auth` - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –±–æ—Ç–∞
- `POST /tg/authorize` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞

## Socket.IO Events

### –ö–ª–∏–µ–Ω—Ç ‚Üí –°–µ—Ä–≤–µ—Ä
- `get-rooms` - –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç
- `create-room` - —Å–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É
- `join-room` - –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∫–æ–º–Ω–∞—Ç–µ
- `rooms-updated` - –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç

### –°–µ—Ä–≤–µ—Ä ‚Üí –ö–ª–∏–µ–Ω—Ç
- `rooms-list` - —Å–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç
- `room-created` - –∫–æ–º–Ω–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞
- `room-joined` - –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å –∫ –∫–æ–º–Ω–∞—Ç–µ
- `room-updated` - –∫–æ–º–Ω–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- `rooms-updated` - —Å–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç –æ–±–Ω–æ–≤–ª–µ–Ω
- `error` - –æ—à–∏–±–∫–∞

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ö–æ–ª–ª–µ–∫—Ü–∏—è: rooms
```javascript
{
  id: String,           // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∫–æ–º–Ω–∞—Ç—ã
  name: String,         // –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã
  creatorId: String,    // ID —Å–æ–∑–¥–∞—Ç–µ–ª—è
  creatorUsername: String,
  maxPlayers: Number,   // –ú–∞–∫—Å–∏–º—É–º –∏–≥—Ä–æ–∫–æ–≤
  timing: Number,       // –í—Ä–µ–º—è —Ö–æ–¥–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
  createdAt: Date,      // –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
  players: [Player],    // –ú–∞—Å—Å–∏–≤ –∏–≥—Ä–æ–∫–æ–≤
  started: Boolean,     // –ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å
  lastActivity: Date,   // –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
  isActive: Boolean     // –ö–æ–º–Ω–∞—Ç–∞ –∞–∫—Ç–∏–≤–Ω–∞
}
```

### –ö–æ–ª–ª–µ–∫—Ü–∏—è: halloffames
```javascript
{
  username: String,     // –ò–º—è –∏–≥—Ä–æ–∫–∞
  games: Number,        // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä
  wins: Number,         // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–±–µ–¥
  points: Number,       // –û—á–∫–∏
  winRate: Number,      // –ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥
  lastPlayed: Date,     // –ü–æ—Å–ª–µ–¥–Ω—è—è –∏–≥—Ä–∞
  totalPlayTime: Number // –û–±—â–µ–µ –≤—Ä–µ–º—è –∏–≥—Ä—ã
}
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
```bash
curl http://localhost:4000/stats
```

–û—Ç–≤–µ—Ç:
```json
{
  "ok": true,
  "totalRooms": 5,
  "totalPlayers": 12,
  "isConnected": true,
  "uptime": 3600,
  "timestamp": "2024-01-01T12:00:00.000Z"
}
```

### –¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤
```bash
curl "http://localhost:4000/hall-of-fame?limit=5&sortBy=points"
```

## –õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞

–°–µ—Ä–≤–µ—Ä –≤—ã–≤–æ–¥–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏:
- `‚úÖ` - —É—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- `‚ùå` - –æ—à–∏–±–∫–∏
- `üîÑ` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- `üè†` - –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫–æ–º–Ω–∞—Ç–∞–º–∏
- `üëã` - –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –∏–≥—Ä–æ–∫–æ–≤
- `üóëÔ∏è` - —É–¥–∞–ª–µ–Ω–∏—è

## –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
```env
MONGODB_URI=mongodb://username:password@host:port/database
PORT=4000
NODE_ENV=production
FRONT_ORIGIN=https://your-frontend-domain.com
```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ MongoDB Atlas –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —á–µ—Ä–µ–∑ `/stats`
3. –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î
