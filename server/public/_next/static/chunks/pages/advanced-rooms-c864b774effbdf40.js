(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[850],{2717:function(e,o,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/advanced-rooms",function(){return r(4969)}])},4969:function(e,o,r){"use strict";r.r(o),r.d(o,{default:function(){return d}});var t=r(5893),n=r(7294),l=r(1163),i=r(7642);let a=["Предприниматель","Инвестор","Финансист","Консультант","Менеджер","Аналитик","Трейдер","Банкир"],s=["Финансовая независимость","Собственный бизнес","Инвестиционный портфель","Пассивный доход","Международная карьера","Образовательный центр","Благотворительный фонд","Технологический стартап"];function d(){let[e,o]=(0,n.useState)(null),[r,d]=(0,n.useState)([]),[c,p]=(0,n.useState)(!1),[x,u]=(0,n.useState)({name:"",maxPlayers:4,timing:120,creatorUsername:"",creatorProfession:"",creatorDream:"",assignProfessionToAll:!1,professionSelectionMode:"choice",password:""}),[g,m]=(0,n.useState)(!1),[h,b]=(0,n.useState)(""),[f,y]=(0,n.useState)(null),[v,j]=(0,n.useState)(""),[D,S]=(0,n.useState)(""),w=(0,l.useRouter)();(0,n.useEffect)(()=>{let e=localStorage.getItem("user");if(!e){w.push("/simple-auth");return}try{let o=JSON.parse(e);y(o),u(e=>({...e,creatorUsername:o.name||"Игрок",creatorProfession:o.profession||"",creatorDream:o.dream||""}))}catch(e){console.error("❌ Ошибка парсинга данных пользователя:",e)}let r="http://localhost:4000";console.log("\uD83D\uDD0C Подключаемся к Advanced Socket.IO:",r);let t=(0,i.io)(r,{transports:["websocket","polling"]});return t.on("connect",()=>{console.log("\uD83D\uDD0C Socket connected:",t.connected),o(t),t.emit("get-rooms")}),t.on("disconnect",()=>{console.log("\uD83D\uDD0C Socket disconnected"),o(null)}),t.on("rooms-list",e=>{console.log("\uD83D\uDCCB Получен список комнат:",e),d(e)}),t.on("room-created",e=>{console.log("\uD83C\uDFE0 Комната создана:",e),d(o=>[...o,e]),b("Комната создана успешно!"),p(!1),console.log("\uD83D\uDEAA Автоматически присоединяемся к комнате:",e.id),t.emit("join-room",{roomId:e.id,playerName:(null==f?void 0:f.name)||"Игрок",playerEmail:(null==f?void 0:f.email)||"player@example.com",profession:v,dream:D}),setTimeout(()=>{w.push("/advanced-room/".concat(e.id))},500)}),t.on("join-room-error",e=>{console.error("❌ Ошибка присоединения к комнате:",e),b("Ошибка: ".concat(e.error))}),t.on("rooms-updated",()=>{console.log("\uD83D\uDD04 Обновляем список комнат..."),t.emit("get-rooms")}),t.on("error",e=>{console.error("❌ Socket error:",e),b("Ошибка: ".concat(e.message))}),()=>{t.close()}},[w,null==f?void 0:f.name,null==f?void 0:f.email,v,D]);let C=o=>{if(!e){b("Нет подключения к серверу");return}m(!0),b(""),e.emit("join-room",{roomId:o,playerName:(null==f?void 0:f.name)||"Игрок",playerEmail:(null==f?void 0:f.email)||"player@example.com",profession:v,dream:D}),setTimeout(()=>{w.push("/advanced-room/".concat(o))},500)},k=e=>{j(e)},B=e=>{S(e)};return(0,t.jsx)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px",fontFamily:"Arial, sans-serif"},children:(0,t.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",background:"rgba(255, 255, 255, 0.95)",borderRadius:"20px",padding:"30px",boxShadow:"0 20px 40px rgba(0,0,0,0.1)"},children:[(0,t.jsxs)("div",{style:{textAlign:"center",marginBottom:"30px"},children:[(0,t.jsx)("h1",{style:{color:"#2d3748",fontSize:"2.5rem",marginBottom:"10px",fontWeight:"bold"},children:"\uD83C\uDFAE Energy of Money - Advanced Rooms"}),(0,t.jsxs)("p",{style:{color:"#718096",fontSize:"1.1rem"},children:["Добро пожаловать, ",(null==f?void 0:f.name)||"Игрок","! Выберите профессию и мечту для игры."]})]}),(0,t.jsxs)("div",{style:{background:"#f7fafc",borderRadius:"15px",padding:"25px",marginBottom:"30px",border:"2px solid #e2e8f0"},children:[(0,t.jsx)("h3",{style:{color:"#2d3748",marginBottom:"20px",fontSize:"1.3rem"},children:"⚙️ Настройка персонажа"}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"10px",fontWeight:"bold",color:"#4a5568"},children:"\uD83C\uDFAD Выберите профессию:"}),(0,t.jsxs)("select",{value:v,onChange:e=>k(e.target.value),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"16px",background:"white"},children:[(0,t.jsx)("option",{value:"",children:"Выберите профессию..."}),a.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"10px",fontWeight:"bold",color:"#4a5568"},children:"\uD83C\uDF1F Выберите мечту:"}),(0,t.jsxs)("select",{value:D,onChange:e=>B(e.target.value),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"16px",background:"white"},children:[(0,t.jsx)("option",{value:"",children:"Выберите мечту..."}),s.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]})]})]}),h&&(0,t.jsx)("div",{style:{background:h.includes("Ошибка")?"#fed7d7":"#c6f6d5",color:h.includes("Ошибка")?"#c53030":"#2f855a",padding:"15px",borderRadius:"10px",marginBottom:"20px",textAlign:"center",fontWeight:"bold"},children:h}),(0,t.jsx)("div",{style:{textAlign:"center",marginBottom:"30px"},children:(0,t.jsx)("button",{onClick:()=>p(!c),style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",padding:"15px 30px",borderRadius:"25px",fontSize:"1.1rem",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 15px rgba(102, 126, 234, 0.4)",transition:"all 0.3s ease"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(102, 126, 234, 0.6)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 15px rgba(102, 126, 234, 0.4)"},children:c?"❌ Отмена":"➕ Создать комнату"})}),c&&(0,t.jsxs)("div",{style:{background:"#f7fafc",borderRadius:"15px",padding:"25px",marginBottom:"30px",border:"2px solid #e2e8f0"},children:[(0,t.jsx)("h3",{style:{color:"#2d3748",marginBottom:"20px",fontSize:"1.3rem"},children:"\uD83C\uDFE0 Создание комнаты"}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"20px"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"bold",color:"#4a5568"},children:"Название комнаты:"}),(0,t.jsx)("input",{type:"text",value:x.name,onChange:e=>u(o=>({...o,name:e.target.value})),placeholder:"Введите название комнаты",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"16px"}})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"bold",color:"#4a5568"},children:"Максимум игроков:"}),(0,t.jsx)("select",{value:x.maxPlayers,onChange:e=>u(o=>({...o,maxPlayers:parseInt(e.target.value)})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"16px"},children:[2,3,4,5,6,7,8,9,10].map(e=>(0,t.jsxs)("option",{value:e,children:[e," игроков"]},e))})]})]}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"20px"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"bold",color:"#4a5568"},children:"Время хода (секунды):"}),(0,t.jsxs)("select",{value:x.timing,onChange:e=>u(o=>({...o,timing:parseInt(e.target.value)})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"16px"},children:[(0,t.jsx)("option",{value:60,children:"60 секунд"}),(0,t.jsx)("option",{value:90,children:"90 секунд"}),(0,t.jsx)("option",{value:120,children:"120 секунд"}),(0,t.jsx)("option",{value:180,children:"180 секунд"}),(0,t.jsx)("option",{value:300,children:"300 секунд"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"bold",color:"#4a5568"},children:"Режим выбора профессий:"}),(0,t.jsxs)("select",{value:x.professionSelectionMode,onChange:e=>u(o=>({...o,professionSelectionMode:e.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"16px"},children:[(0,t.jsx)("option",{value:"choice",children:"Выбор игроками"}),(0,t.jsx)("option",{value:"random",children:"Случайный"}),(0,t.jsx)("option",{value:"assigned",children:"Назначенные"})]})]})]}),(0,t.jsx)("div",{style:{textAlign:"center"},children:(0,t.jsx)("button",{onClick:()=>{if(!e){b("Нет подключения к серверу");return}if(!x.name.trim()){b("Введите название комнаты");return}m(!0),b(""),e.emit("create-room",x)},disabled:g,style:{background:g?"#a0aec0":"linear-gradient(135deg, #48bb78 0%, #38a169 100%)",color:"white",border:"none",padding:"15px 30px",borderRadius:"25px",fontSize:"1.1rem",fontWeight:"bold",cursor:g?"not-allowed":"pointer",boxShadow:"0 4px 15px rgba(72, 187, 120, 0.4)",transition:"all 0.3s ease"},children:g?"⏳ Создание...":"\uD83D\uDE80 Создать комнату"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{style:{color:"#2d3748",marginBottom:"20px",fontSize:"1.8rem",textAlign:"center"},children:["\uD83C\uDFE0 Доступные комнаты (",r.length,")"]}),0===r.length?(0,t.jsx)("div",{style:{textAlign:"center",padding:"40px",color:"#718096",fontSize:"1.1rem"},children:"Нет доступных комнат. Создайте новую!"}):(0,t.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))",gap:"20px"},children:r.map(e=>(0,t.jsxs)("div",{style:{background:"white",borderRadius:"15px",padding:"20px",border:"2px solid #e2e8f0",boxShadow:"0 4px 15px rgba(0,0,0,0.1)",transition:"all 0.3s ease"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-5px)",e.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 15px rgba(0,0,0,0.1)"},children:[(0,t.jsx)("h3",{style:{color:"#2d3748",marginBottom:"15px",fontSize:"1.3rem",fontWeight:"bold"},children:e.name}),(0,t.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,t.jsxs)("p",{style:{color:"#4a5568",margin:"5px 0"},children:["\uD83D\uDC65 Игроки: ",e.currentPlayers,"/",e.maxPlayers]}),(0,t.jsxs)("p",{style:{color:"#4a5568",margin:"5px 0"},children:["⏱️ Время хода: ",e.timing," сек"]}),(0,t.jsxs)("p",{style:{color:"#4a5568",margin:"5px 0"},children:["\uD83D\uDC64 Создатель: ",e.creator]}),(0,t.jsxs)("p",{style:{color:"#4a5568",margin:"5px 0"},children:["\uD83C\uDFAD Режим профессий: ",e.professionSelectionMode]}),(0,t.jsxs)("p",{style:{color:"#4a5568",margin:"5px 0"},children:["\uD83D\uDCC5 Создана: ",new Date(e.createdAt).toLocaleString()]})]}),(0,t.jsx)("button",{onClick:()=>C(e.id),disabled:g||e.started||e.currentPlayers>=e.maxPlayers,style:{width:"100%",background:e.started||e.currentPlayers>=e.maxPlayers?"#a0aec0":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",padding:"12px",borderRadius:"10px",fontSize:"1rem",fontWeight:"bold",cursor:e.started||e.currentPlayers>=e.maxPlayers?"not-allowed":"pointer",transition:"all 0.3s ease"},children:e.started?"\uD83C\uDFAE Игра началась":e.currentPlayers>=e.maxPlayers?"❌ Комната заполнена":g?"⏳ Присоединение...":"\uD83D\uDEAA Присоединиться"})]},e.id))})]}),(0,t.jsx)("div",{style:{position:"fixed",top:"20px",right:"20px",background:(null==e?void 0:e.connected)?"#c6f6d5":"#fed7d7",color:(null==e?void 0:e.connected)?"#2f855a":"#c53030",padding:"10px 15px",borderRadius:"20px",fontSize:"0.9rem",fontWeight:"bold",boxShadow:"0 4px 15px rgba(0,0,0,0.1)"},children:(null==e?void 0:e.connected)?"\uD83D\uDFE2 Подключено":"\uD83D\uDD34 Отключено"})]})})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=2717)}),_N_E=e.O()}]);