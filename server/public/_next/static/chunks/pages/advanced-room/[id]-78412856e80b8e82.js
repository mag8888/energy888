(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[434],{7137:function(e,o,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/advanced-room/[id]",function(){return r(5028)}])},5028:function(e,o,r){"use strict";r.r(o),r.d(o,{default:function(){return s}});var t=r(5893),n=r(7294),i=r(1163),d=r(7642);let l=["Предприниматель","Инвестор","Финансист","Консультант","Менеджер","Аналитик","Трейдер","Банкир"],a=["Финансовая независимость","Собственный бизнес","Инвестиционный портфель","Пассивный доход","Международная карьера","Образовательный центр","Благотворительный фонд","Технологический стартап"];function s(){let[e,o]=(0,n.useState)(null),[r,s]=(0,n.useState)(null),[c,p]=(0,n.useState)(!0),[x,u]=(0,n.useState)(""),[g,h]=(0,n.useState)(null),[m,b]=(0,n.useState)(""),[f,y]=(0,n.useState)(""),[j,D]=(0,n.useState)(!1),[v,k]=(0,n.useState)(!1),S=(0,i.useRouter)(),{id:C}=S.query;(0,n.useEffect)(()=>{if(!C)return;let e=localStorage.getItem("user");if(!e){S.push("/simple-auth");return}try{let o=JSON.parse(e);h(o)}catch(e){console.error("❌ Ошибка парсинга данных пользователя:",e)}let r="http://localhost:4000";console.log("\uD83D\uDD0C Подключаемся к Advanced Socket.IO:",r);let t=(0,d.io)(r,{transports:["websocket","polling"]});return t.on("connect",()=>{console.log("\uD83D\uDD0C Socket connected:",t.connected),o(t),t.emit("get-room-info",{roomId:C})}),t.on("disconnect",()=>{console.log("\uD83D\uDD0C Socket disconnected"),o(null)}),t.on("room-info",e=>{console.log("\uD83C\uDFE0 Информация о комнате:",e),s(e),p(!1);let o=e.players.find(e=>e.socketId===t.id);o&&(b(o.profession||""),y(o.dream||""))}),t.on("room-info-error",e=>{console.error("❌ Ошибка получения информации о комнате:",e),u("Ошибка: ".concat(e.error)),p(!1)}),t.on("player-joined",e=>{console.log("\uD83D\uDC64 Игрок присоединился:",e.player.name),s(o=>o?{...o,players:e.players}:null)}),t.on("player-left",e=>{console.log("\uD83D\uDC4B Игрок покинул комнату:",e.player.name),s(o=>o?{...o,players:e.players}:null)}),t.on("player-updated",e=>{console.log("⚙️ Игрок обновлен:",e.player.name),s(o=>o?{...o,players:e.players}:null)}),t.on("player-ready-updated",e=>{console.log("✅ Готовность игрока обновлена:",e.player.name),s(o=>o?{...o,players:e.players}:null)}),t.on("game-started",e=>{console.log("\uD83C\uDFAE Игра началась!"),s(e=>e?{...e,started:!0}:null),u("\uD83C\uDF89 Игра началась! Удачи!")}),t.on("join-room-error",e=>{console.error("❌ Ошибка присоединения к комнате:",e),u("Ошибка: ".concat(e.error))}),t.on("setup-error",e=>{console.error("❌ Ошибка настройки игрока:",e),u("Ошибка: ".concat(e.error))}),t.on("error",e=>{console.error("❌ Socket error:",e),u("Ошибка: ".concat(e.message))}),()=>{t.close()}},[C,S]);let w=o=>{e&&r&&(b(o),D(!1),e.emit("player-setup",{roomId:r.id,profession:o,dream:f}))},R=o=>{e&&r&&(y(o),k(!1),e.emit("player-setup",{roomId:r.id,profession:m,dream:o}))},A=()=>{e&&r&&e.emit("player-ready",{roomId:r.id})};if(c)return(0,t.jsx)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"Arial, sans-serif"},children:(0,t.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.95)",borderRadius:"20px",padding:"40px",textAlign:"center",boxShadow:"0 20px 40px rgba(0,0,0,0.1)"},children:[(0,t.jsx)("div",{style:{fontSize:"3rem",marginBottom:"20px"},children:"⏳"}),(0,t.jsx)("h2",{style:{color:"#2d3748",marginBottom:"10px"},children:"Загрузка комнаты..."}),(0,t.jsx)("p",{style:{color:"#718096"},children:"Подключаемся к серверу..."})]})});if(!r)return(0,t.jsx)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"Arial, sans-serif"},children:(0,t.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.95)",borderRadius:"20px",padding:"40px",textAlign:"center",boxShadow:"0 20px 40px rgba(0,0,0,0.1)"},children:[(0,t.jsx)("div",{style:{fontSize:"3rem",marginBottom:"20px"},children:"❌"}),(0,t.jsx)("h2",{style:{color:"#2d3748",marginBottom:"10px"},children:"Комната не найдена"}),(0,t.jsx)("p",{style:{color:"#718096",marginBottom:"20px"},children:"Комната не существует или была удалена"}),(0,t.jsx)("button",{onClick:()=>S.push("/advanced-rooms"),style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",padding:"12px 24px",borderRadius:"25px",fontSize:"1rem",fontWeight:"bold",cursor:"pointer"},children:"\uD83C\uDFE0 Вернуться к списку комнат"})]})});let z=r.players.find(o=>o.socketId===(null==e?void 0:e.id)),B=r.players.length>=2&&r.players.every(e=>e.isReady);return(0,t.jsx)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px",fontFamily:"Arial, sans-serif"},children:(0,t.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",background:"rgba(255, 255, 255, 0.95)",borderRadius:"20px",padding:"30px",boxShadow:"0 20px 40px rgba(0,0,0,0.1)"},children:[(0,t.jsxs)("div",{style:{textAlign:"center",marginBottom:"30px"},children:[(0,t.jsxs)("h1",{style:{color:"#2d3748",fontSize:"2.5rem",marginBottom:"10px",fontWeight:"bold"},children:["\uD83C\uDFE0 ",r.name]}),(0,t.jsxs)("p",{style:{color:"#718096",fontSize:"1.1rem"},children:["Создатель: ",r.creator," • Игроков: ",r.players.length,"/",r.maxPlayers]})]}),x&&(0,t.jsx)("div",{style:{background:x.includes("Ошибка")?"#fed7d7":"#c6f6d5",color:x.includes("Ошибка")?"#c53030":"#2f855a",padding:"15px",borderRadius:"10px",marginBottom:"20px",textAlign:"center",fontWeight:"bold"},children:x}),r.started?(0,t.jsx)("div",{style:{background:"#c6f6d5",color:"#2f855a",padding:"20px",borderRadius:"15px",textAlign:"center",marginBottom:"30px",fontWeight:"bold",fontSize:"1.2rem"},children:"\uD83C\uDFAE Игра началась! Удачи всем игрокам!"}):(0,t.jsxs)("div",{style:{background:"#bee3f8",color:"#2b6cb0",padding:"20px",borderRadius:"15px",textAlign:"center",marginBottom:"30px",fontWeight:"bold",fontSize:"1.2rem"},children:["⏳ Ожидание игроков... ",B?"Все готовы!":'Настройте персонажа и нажмите "Готов"']}),(0,t.jsxs)("div",{style:{marginBottom:"30px"},children:[(0,t.jsxs)("h2",{style:{color:"#2d3748",marginBottom:"20px",fontSize:"1.8rem",textAlign:"center"},children:["\uD83D\uDC65 Игроки (",r.players.length,")"]}),(0,t.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px"},children:r.players.map(o=>(0,t.jsxs)("div",{style:{background:o.socketId===(null==e?void 0:e.id)?"#e6fffa":"white",borderRadius:"15px",padding:"20px",border:o.socketId===(null==e?void 0:e.id)?"3px solid #38b2ac":"2px solid #e2e8f0",boxShadow:"0 4px 15px rgba(0,0,0,0.1)",position:"relative"},children:[o.socketId===(null==e?void 0:e.id)&&(0,t.jsx)("div",{style:{position:"absolute",top:"-10px",right:"-10px",background:"#38b2ac",color:"white",padding:"5px 10px",borderRadius:"15px",fontSize:"0.8rem",fontWeight:"bold"},children:"ВЫ"}),(0,t.jsx)("h3",{style:{color:"#2d3748",marginBottom:"15px",fontSize:"1.3rem",fontWeight:"bold"},children:o.name}),(0,t.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,t.jsxs)("p",{style:{color:"#4a5568",margin:"5px 0"},children:["\uD83C\uDFAD Профессия: ",o.profession||"Не выбрана"]}),(0,t.jsxs)("p",{style:{color:"#4a5568",margin:"5px 0"},children:["\uD83C\uDF1F Мечта: ",o.dream||"Не выбрана"]}),(0,t.jsxs)("p",{style:{color:"#4a5568",margin:"5px 0"},children:["\uD83D\uDCB0 Деньги: ",o.money]}),(0,t.jsxs)("p",{style:{color:"#4a5568",margin:"5px 0"},children:["\uD83D\uDCC5 Присоединился: ",new Date(o.joinedAt).toLocaleString()]})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,t.jsx)("div",{style:{background:o.isReady?"#c6f6d5":"#fed7d7",color:o.isReady?"#2f855a":"#c53030",padding:"8px 12px",borderRadius:"20px",fontSize:"0.9rem",fontWeight:"bold"},children:o.isReady?"✅ Готов":"⏳ Не готов"}),o.socketId===(null==e?void 0:e.id)&&(0,t.jsx)("button",{onClick:A,style:{background:o.isReady?"linear-gradient(135deg, #f56565 0%, #e53e3e 100%)":"linear-gradient(135deg, #48bb78 0%, #38a169 100%)",color:"white",border:"none",padding:"8px 16px",borderRadius:"20px",fontSize:"0.9rem",fontWeight:"bold",cursor:"pointer"},children:o.isReady?"❌ Не готов":"✅ Готов"})]})]},o.id))})]}),z&&!r.started&&(0,t.jsxs)("div",{style:{background:"#f7fafc",borderRadius:"15px",padding:"25px",marginBottom:"30px",border:"2px solid #e2e8f0"},children:[(0,t.jsx)("h3",{style:{color:"#2d3748",marginBottom:"20px",fontSize:"1.3rem"},children:"⚙️ Настройка персонажа"}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"10px",fontWeight:"bold",color:"#4a5568"},children:"\uD83C\uDFAD Профессия:"}),(0,t.jsx)("div",{style:{background:"white",borderRadius:"10px",padding:"15px",border:"2px solid #e2e8f0",cursor:"pointer",textAlign:"center",fontWeight:"bold",color:m?"#2d3748":"#a0aec0"},onClick:()=>D(!0),children:m||"Выберите профессию..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"10px",fontWeight:"bold",color:"#4a5568"},children:"\uD83C\uDF1F Мечта:"}),(0,t.jsx)("div",{style:{background:"white",borderRadius:"10px",padding:"15px",border:"2px solid #e2e8f0",cursor:"pointer",textAlign:"center",fontWeight:"bold",color:f?"#2d3748":"#a0aec0"},onClick:()=>k(!0),children:f||"Выберите мечту..."})]})]})]}),(0,t.jsxs)("div",{style:{textAlign:"center"},children:[(0,t.jsx)("button",{onClick:()=>{e&&r&&(e.emit("leave-room",{roomId:r.id}),S.push("/advanced-rooms"))},style:{background:"linear-gradient(135deg, #f56565 0%, #e53e3e 100%)",color:"white",border:"none",padding:"15px 30px",borderRadius:"25px",fontSize:"1.1rem",fontWeight:"bold",cursor:"pointer",marginRight:"20px",boxShadow:"0 4px 15px rgba(245, 101, 101, 0.4)"},children:"\uD83D\uDEAA Покинуть комнату"}),(0,t.jsx)("button",{onClick:()=>S.push("/advanced-rooms"),style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",padding:"15px 30px",borderRadius:"25px",fontSize:"1.1rem",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 15px rgba(102, 126, 234, 0.4)"},children:"\uD83C\uDFE0 К списку комнат"})]}),j&&(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,t.jsxs)("div",{style:{background:"white",borderRadius:"20px",padding:"30px",maxWidth:"500px",width:"90%",maxHeight:"80vh",overflow:"auto"},children:[(0,t.jsx)("h3",{style:{color:"#2d3748",marginBottom:"20px",fontSize:"1.5rem",textAlign:"center"},children:"\uD83C\uDFAD Выберите профессию"}),(0,t.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px",marginBottom:"20px"},children:l.map(e=>(0,t.jsx)("button",{onClick:()=>w(e),style:{background:m===e?"linear-gradient(135deg, #48bb78 0%, #38a169 100%)":"white",color:m===e?"white":"#2d3748",border:"2px solid #e2e8f0",padding:"15px",borderRadius:"10px",fontSize:"1rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease"},children:e},e))}),(0,t.jsx)("div",{style:{textAlign:"center"},children:(0,t.jsx)("button",{onClick:()=>D(!1),style:{background:"#a0aec0",color:"white",border:"none",padding:"10px 20px",borderRadius:"20px",fontSize:"1rem",fontWeight:"bold",cursor:"pointer"},children:"❌ Отмена"})})]})}),v&&(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,t.jsxs)("div",{style:{background:"white",borderRadius:"20px",padding:"30px",maxWidth:"500px",width:"90%",maxHeight:"80vh",overflow:"auto"},children:[(0,t.jsx)("h3",{style:{color:"#2d3748",marginBottom:"20px",fontSize:"1.5rem",textAlign:"center"},children:"\uD83C\uDF1F Выберите мечту"}),(0,t.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px",marginBottom:"20px"},children:a.map(e=>(0,t.jsx)("button",{onClick:()=>R(e),style:{background:f===e?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"white",color:f===e?"white":"#2d3748",border:"2px solid #e2e8f0",padding:"15px",borderRadius:"10px",fontSize:"1rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease"},children:e},e))}),(0,t.jsx)("div",{style:{textAlign:"center"},children:(0,t.jsx)("button",{onClick:()=>k(!1),style:{background:"#a0aec0",color:"white",border:"none",padding:"10px 20px",borderRadius:"20px",fontSize:"1rem",fontWeight:"bold",cursor:"pointer"},children:"❌ Отмена"})})]})}),(0,t.jsx)("div",{style:{position:"fixed",top:"20px",right:"20px",background:(null==e?void 0:e.connected)?"#c6f6d5":"#fed7d7",color:(null==e?void 0:e.connected)?"#2f855a":"#c53030",padding:"10px 15px",borderRadius:"20px",fontSize:"0.9rem",fontWeight:"bold",boxShadow:"0 4px 15px rgba(0,0,0,0.1)"},children:(null==e?void 0:e.connected)?"\uD83D\uDFE2 Подключено":"\uD83D\uDD34 Отключено"})]})})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=7137)}),_N_E=e.O()}]);